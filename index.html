<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>اختبار أساسيات الكمبيوتر للأطفال</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap');
        body { font-family: 'Cairo', sans-serif; }
        .question-card { transition: all 0.3s ease; }
        .question-card:hover { transform: translateY(-2px); }
        .option-btn { transition: all 0.2s ease; }
        .option-btn:hover { transform: scale(1.02); }
        .correct { background: linear-gradient(135deg, #10b981, #059669); }
        .incorrect { background: linear-gradient(135deg, #ef4444, #dc2626); }
        .device-icon { font-size: 3rem; cursor: pointer; transition: all 0.2s ease; }
        .device-icon:hover { transform: scale(1.1); }
        .selected { background: #3b82f6; color: white; }
        .drag-item { cursor: move; transition: all 0.2s ease; }
        .drag-item:hover { transform: scale(1.05); }
        .drop-zone { min-height: 60px; transition: all 0.2s ease; }
        .drop-zone.drag-over { background: #dbeafe; border: 2px dashed #3b82f6; }
        .hidden { display: none; }
        #testContent { display: none; }
        .feedback { position: fixed; top: 20px; right: 20px; padding: 12px 20px; border-radius: 8px; z-index: 1000; font-weight: bold; }
        .success { background-color: #10B981; color: white; }
        .error { background-color: #EF4444; color: white; }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-purple-50 min-h-screen">
    <div class="container mx-auto px-4 py-8 max-w-4xl">
        <!-- تسجيل الدخول -->
        <div id="loginSection" class="bg-white rounded-xl shadow-lg p-6 mb-6">
            <h2 class="text-2xl font-bold text-blue-800 mb-4">👤 تسجيل دخول</h2>
            <p class="text-gray-600 mb-4">سجل معلوماتك لبدء الاختبار واستلام النتيجة</p>
            
            <form id="loginForm" class="space-y-4">
                <div>
                    <label class="block text-gray-700 mb-2">اسم الطفل:</label>
                    <input type="text" id="childName" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="أدخل اسمك">
                </div>
                
                <div>
                    <label class="block text-gray-700 mb-2">رقم ولي الأمر:</label>
                    <input type="tel" id="parentPhone" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="01xxxxxxxx">
                </div>
                
                <div>
                    <label class="block text-gray-700 mb-2">البريد الإلكتروني:</label>
                    <input type="email" id="parentEmail" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="email@example.com">
                </div>
                
                <button type="submit" class="w-full bg-blue-500 text-white py-3 rounded-lg hover:bg-blue-600 transition duration-300">
                    بدء الاختبار
                </button>
            </form>
        </div>

        <!-- محتوى الاختبار -->
        <div id="testContent">
            <!-- Header -->
            <div class="text-center mb-8">
                <h1 class="text-4xl font-bold text-blue-800 mb-4">🖥️ اختبار أساسيات الكمبيوتر</h1>
                <p class="text-lg text-gray-600">اختبر معلوماتك عن الكمبيوتر بطريقة ممتعة!</p>
                <div class="mt-4 bg-white rounded-full px-6 py-2 inline-block shadow-md">
                    <span class="text-blue-600 font-semibold">السؤال <span id="currentQ">1</span> من <span id="totalQ">15</span></span>
                </div>
            </div>

            <!-- Progress Bar -->
            <div class="w-full bg-gray-200 rounded-full h-3 mb-8">
                <div id="progressBar" class="bg-gradient-to-r from-blue-500 to-purple-500 h-3 rounded-full transition-all duration-300" style="width: 6.67%"></div>
            </div>

            <!-- Questions Container -->
            <div id="questionsContainer">
                <!-- Question 1: Multiple Choice -->
                <div class="question-card bg-white rounded-xl shadow-lg p-6 mb-6" data-question="1">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">1️⃣ ما هو تعريف كلمة "Computer"؟</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                        <button class="option-btn bg-blue-50 hover:bg-blue-100 p-4 rounded-lg text-right border-2 border-transparent" data-answer="wrong">
                            آلة للكتابة فقط ✏️
                        </button>
                        <button class="option-btn bg-blue-50 hover:bg-blue-100 p-4 rounded-lg text-right border-2 border-transparent" data-answer="correct">
                            جهاز إلكتروني بيعالج البيانات وبيخزن المعلومات 💻
                        </button>
                        <button class="option-btn bg-blue-50 hover:bg-blue-100 p-4 rounded-lg text-right border-2 border-transparent" data-answer="wrong">
                            جهاز صوتي 🔊
                        </button>
                        <button class="option-btn bg-blue-50 hover:bg-blue-100 p-4 rounded-lg text-right border-2 border-transparent" data-answer="wrong">
                            شاشة عرض 📺
                        </button>
                    </div>
                </div>

                <!-- Question 2: True/False -->
                <div class="question-card bg-white rounded-xl shadow-lg p-6 mb-6 hidden" data-question="2">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">2️⃣ صح ولا غلط: الـ Hardware هو كل حاجة نقدر نلمسها في الكمبيوتر</h3>
                    <div class="flex justify-center gap-6">
                        <button class="option-btn bg-green-50 hover:bg-green-100 px-8 py-4 rounded-lg text-xl font-bold border-2 border-transparent" data-answer="correct">
                            ✅ صح
                        </button>
                        <button class="option-btn bg-red-50 hover:bg-red-100 px-8 py-4 rounded-lg text-xl font-bold border-2 border-transparent" data-answer="wrong">
                            ❌ غلط
                        </button>
                    </div>
                </div>

                <!-- Question 3: Multiple Choice -->
                <div class="question-card bg-white rounded-xl shadow-lg p-6 mb-6 hidden" data-question="3">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">3️⃣ الـ Software هو:</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                        <button class="option-btn bg-purple-50 hover:bg-purple-100 p-4 rounded-lg text-right border-2 border-transparent" data-answer="wrong">
                            الكيبورد ⌨️
                        </button>
                        <button class="option-btn bg-purple-50 hover:bg-purple-100 p-4 rounded-lg text-right border-2 border-transparent" data-answer="correct">
                            البرامج اللي بتشتغل جوا الجهاز 💾
                        </button>
                        <button class="option-btn bg-purple-50 hover:bg-purple-100 p-4 rounded-lg text-right border-2 border-transparent" data-answer="wrong">
                            الماوس 🖱️
                        </button>
                        <button class="option-btn bg-purple-50 hover:bg-purple-100 p-4 rounded-lg text-right border-2 border-transparent" data-answer="wrong">
                            الشاشة 🖥️
                        </button>
                    </div>
                </div>

                <!-- Question 4: Visual Selection -->
                <div class="question-card bg-white rounded-xl shadow-lg p-6 mb-6 hidden" data-question="4">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">4️⃣ أي من هذه الأجهزة يعتبر Input Device؟ (اختر كل الصح)</h3>
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                        <div class="device-icon text-center p-4 bg-gray-50 rounded-lg border-2 border-transparent" data-answer="correct" data-device="mouse">
                            🖱️<br><span class="text-sm">ماوس</span>
                        </div>
                        <div class="device-icon text-center p-4 bg-gray-50 rounded-lg border-2 border-transparent" data-answer="correct" data-device="camera">
                            📷<br><span class="text-sm">كاميرا</span>
                        </div>
                        <div class="device-icon text-center p-4 bg-gray-50 rounded-lg border-2 border-transparent" data-answer="wrong" data-device="monitor">
                            🖥️<br><span class="text-sm">شاشة</span>
                        </div>
                        <div class="device-icon text-center p-4 bg-gray-50 rounded-lg border-2 border-transparent" data-answer="wrong" data-device="printer">
                            🖨️<br><span class="text-sm">طابعة</span>
                        </div>
                    </div>
                    <button id="checkDevices" class="mt-4 bg-blue-500 text-white px-6 py-2 rounded-lg hover:bg-blue-600 hidden">تحقق من الإجابة</button>
                </div>

                <!-- Question 5: Multiple Choice -->
                <div class="question-card bg-white rounded-xl shadow-lg p-6 mb-6 hidden" data-question="5">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">5️⃣ اختر الـ Output Device من دول:</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                        <button class="option-btn bg-orange-50 hover:bg-orange-100 p-4 rounded-lg text-right border-2 border-transparent" data-answer="wrong">
                            كاميرا 📷
                        </button>
                        <button class="option-btn bg-orange-50 hover:bg-orange-100 p-4 rounded-lg text-right border-2 border-transparent" data-answer="correct">
                            سماعة 🔊
                        </button>
                        <button class="option-btn bg-orange-50 hover:bg-orange-100 p-4 rounded-lg text-right border-2 border-transparent" data-answer="wrong">
                            مايك 🎤
                        </button>
                        <button class="option-btn bg-orange-50 hover:bg-orange-100 p-4 rounded-lg text-right border-2 border-transparent" data-answer="wrong">
                            ماوس 🖱️
                        </button>
                    </div>
                </div>

                <!-- Question 6: Matching -->
                <div class="question-card bg-white rounded-xl shadow-lg p-6 mb-6 hidden" data-question="6">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">6️⃣ وصّل كل جهاز بنوعه:</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="space-y-3">
                            <h4 class="font-semibold text-gray-700">الأجهزة:</h4>
                            <div class="drag-item bg-blue-100 p-3 rounded-lg cursor-move" draggable="true" data-device="keyboard">
                                ⌨️ كيبورد
                            </div>
                            <div class="drag-item bg-blue-100 p-3 rounded-lg cursor-move" draggable="true" data-device="printer">
                                🖨️ طابعة
                            </div>
                            <div class="drag-item bg-blue-100 p-3 rounded-lg cursor-move" draggable="true" data-device="monitor">
                                🖥️ شاشة
                            </div>
                            <div class="drag-item bg-blue-100 p-3 rounded-lg cursor-move" draggable="true" data-device="microphone">
                                🎤 ميكروفون
                            </div>
                        </div>
                        <div class="space-y-3">
                            <h4 class="font-semibold text-gray-700">النوع:</h4>
                            <div class="drop-zone bg-green-50 border-2 border-dashed border-green-300 p-3 rounded-lg" data-type="input">
                                <strong>Input Device</strong>
                                <div class="dropped-items mt-2"></div>
                            </div>
                            <div class="drop-zone bg-red-50 border-2 border-dashed border-red-300 p-3 rounded-lg" data-type="output">
                                <strong>Output Device</strong>
                                <div class="dropped-items mt-2"></div>
                            </div>
                        </div>
                    </div>
                    <button id="checkMatching" class="mt-4 bg-blue-500 text-white px-6 py-2 rounded-lg hover:bg-blue-600">تحقق من التوصيل</button>
                </div>

                <!-- Question 7: Multiple Choice -->
                <div class="question-card bg-white rounded-xl shadow-lg p-6 mb-6 hidden" data-question="7">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">7️⃣ ما هو المعالج (Processor) مسؤول عن:</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                        <button class="option-btn bg-indigo-50 hover:bg-indigo-100 p-4 rounded-lg text-right border-2 border-transparent" data-answer="wrong">
                            تخزين الملفات 💾
                        </button>
                        <button class="option-btn bg-indigo-50 hover:bg-indigo-100 p-4 rounded-lg text-right border-2 border-transparent" data-answer="wrong">
                            إخراج الصوت 🔊
                        </button>
                        <button class="option-btn bg-indigo-50 hover:bg-indigo-100 p-4 rounded-lg text-right border-2 border-transparent" data-answer="correct">
                            معالجة البيانات وتنفيذ الأوامر 🧠
                        </button>
                        <button class="option-btn bg-indigo-50 hover:bg-indigo-100 p-4 rounded-lg text-right border-2 border-transparent" data-answer="wrong">
                            توصيل الإنترنت 🌐
                        </button>
                    </div>
                </div>

                <!-- Question 8: Multiple Choice -->
                <div class="question-card bg-white rounded-xl shadow-lg p-6 mb-6 hidden" data-question="8">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">8️⃣ أي مكوّن من دول موجود جوا الكمبيوتر؟</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                        <button class="option-btn bg-teal-50 hover:bg-teal-100 p-4 rounded-lg text-right border-2 border-transparent" data-answer="wrong">
                            طابعة 🖨️
                        </button>
                        <button class="option-btn bg-teal-50 hover:bg-teal-100 p-4 rounded-lg text-right border-2 border-transparent" data-answer="correct">
                            RAM 💾
                        </button>
                        <button class="option-btn bg-teal-50 hover:bg-teal-100 p-4 rounded-lg text-right border-2 border-transparent" data-answer="wrong">
                            ماوس 🖱️
                        </button>
                        <button class="option-btn bg-teal-50 hover:bg-teal-100 p-4 rounded-lg text-right border-2 border-transparent" data-answer="wrong">
                            شاشة 🖥️
                        </button>
                    </div>
                </div>

                <!-- Question 9: Ordering -->
                <div class="question-card bg-white rounded-xl shadow-lg p-6 mb-6 hidden" data-question="9">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">9️⃣ رتّب خطوات تشغيل الجهاز بالترتيب الصحيح:</h3>
                    <div id="sortableSteps" class="space-y-3">
                        <div class="step-item bg-yellow-100 p-3 rounded-lg cursor-move border-2 border-transparent" draggable="true" data-order="5">
                            5️⃣ ظهور سطح المكتب
                        </div>
                        <div class="step-item bg-yellow-100 p-3 rounded-lg cursor-move border-2 border-transparent" draggable="true" data-order="1">
                            1️⃣ توصيل الكهرباء
                        </div>
                        <div class="step-item bg-yellow-100 p-3 rounded-lg cursor-move border-2 border-transparent" draggable="true" data-order="4">
                            4️⃣ تحميل نظام التشغيل (Windows)
                        </div>
                        <div class="step-item bg-yellow-100 p-3 rounded-lg cursor-move border-2 border-transparent" draggable="true" data-order="2">
                            2️⃣ الضغط على زر التشغيل
                        </div>
                        <div class="step-item bg-yellow-100 p-3 rounded-lg cursor-move border-2 border-transparent" draggable="true" data-order="3">
                            3️⃣ تحميل الـ BIOS من ROM
                        </div>
                    </div>
                    <button id="checkOrder" class="mt-4 bg-blue-500 text-white px-6 py-2 rounded-lg hover:bg-blue-600">تحقق من الترتيب</button>
                </div>

                <!-- Question 10: Multiple Choice -->
                <div class="question-card bg-white rounded-xl shadow-lg p-6 mb-6 hidden" data-question="10">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">🔟 عند تشغيل الجهاز، أول حاجة تشتغل هي:</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                        <button class="option-btn bg-pink-50 hover:bg-pink-100 p-4 rounded-lg text-right border-2 border-transparent" data-answer="correct">
                            برنامج موجود في ROM 💾
                        </button>
                        <button class="option-btn bg-pink-50 hover:bg-pink-100 p-4 rounded-lg text-right border-2 border-transparent" data-answer="wrong">
                            شاشة سطح المكتب 🖥️
                        </button>
                        <button class="option-btn bg-pink-50 hover:bg-pink-100 p-4 rounded-lg text-right border-2 border-transparent" data-answer="wrong">
                            المتصفح 🌐
                        </button>
                        <button class="option-btn bg-pink-50 hover:bg-pink-100 p-4 rounded-lg text-right border-2 border-transparent" data-answer="wrong">
                            الصوت 🔊
                        </button>
                    </div>
                </div>

                <!-- Question 11: Multiple Choice -->
                <div class="question-card bg-white rounded-xl shadow-lg p-6 mb-6 hidden" data-question="11">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">1️⃣1️⃣ ما الفرق بين الفايل (File) والفولدر (Folder)؟</h3>
                    <div class="grid grid-cols-1 gap-3">
                        <button class="option-btn bg-cyan-50 hover:bg-cyan-100 p-4 rounded-lg text-right border-2 border-transparent" data-answer="correct">
                            File بيحتوي على محتوى، Folder بينظم الملفات 📁📄
                        </button>
                        <button class="option-btn bg-cyan-50 hover:bg-cyan-100 p-4 rounded-lg text-right border-2 border-transparent" data-answer="wrong">
                            الاتنين نفس الشيء
                        </button>
                        <button class="option-btn bg-cyan-50 hover:bg-cyan-100 p-4 rounded-lg text-right border-2 border-transparent" data-answer="wrong">
                            Folder بيشتغل صوت 🔊
                        </button>
                        <button class="option-btn bg-cyan-50 hover:bg-cyan-100 p-4 rounded-lg text-right border-2 border-transparent" data-answer="wrong">
                            File بيحذف المجلدات
                        </button>
                    </div>
                </div>

                <!-- Question 12: True/False -->
                <div class="question-card bg-white rounded-xl shadow-lg p-6 mb-6 hidden" data-question="12">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">1️⃣2️⃣ صح ولا غلط: المجلد يقدر يحتوي على مجلدات تانية جواه</h3>
                    <div class="flex justify-center gap-6">
                        <button class="option-btn bg-green-50 hover:bg-green-100 px-8 py-4 rounded-lg text-xl font-bold border-2 border-transparent" data-answer="correct">
                            ✅ صح
                        </button>
                        <button class="option-btn bg-red-50 hover:bg-red-100 px-8 py-4 rounded-lg text-xl font-bold border-2 border-transparent" data-answer="wrong">
                            ❌ غلط
                        </button>
                    </div>
                </div>

                <!-- Question 13: Multiple Choice -->
                <div class="question-card bg-white rounded-xl shadow-lg p-6 mb-6 hidden" data-question="13">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">1️⃣3️⃣ لما نعمل مجلد جديد، بيكون اسمه تلقائي:</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                        <button class="option-btn bg-lime-50 hover:bg-lime-100 p-4 rounded-lg text-right border-2 border-transparent" data-answer="wrong">
                            My Computer 💻
                        </button>
                        <button class="option-btn bg-lime-50 hover:bg-lime-100 p-4 rounded-lg text-right border-2 border-transparent" data-answer="correct">
                            New Folder 📁
                        </button>
                        <button class="option-btn bg-lime-50 hover:bg-lime-100 p-4 rounded-lg text-right border-2 border-transparent" data-answer="wrong">
                            Desktop 🖥️
                        </button>
                        <button class="option-btn bg-lime-50 hover:bg-lime-100 p-4 rounded-lg text-right border-2 border-transparent" data-answer="wrong">
                            Start ▶️
                        </button>
                    </div>
                </div>

                <!-- Question 14: Multiple Choice -->
                <div class="question-card bg-white rounded-xl shadow-lg p-6 mb-6 hidden" data-question="14">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">1️⃣4️⃣ عشان نعمل فولدر جديد، نضغط:</h3>
                    <div class="grid grid-cols-1 gap-3">
                        <button class="option-btn bg-amber-50 hover:bg-amber-100 p-4 rounded-lg text-right border-2 border-transparent" data-answer="wrong">
                            Alt + F4
                        </button>
                        <button class="option-btn bg-amber-50 hover:bg-amber-100 p-4 rounded-lg text-right border-2 border-transparent" data-answer="wrong">
                            Ctrl + C
                        </button>
                        <button class="option-btn bg-amber-50 hover:bg-amber-100 p-4 rounded-lg text-right border-2 border-transparent" data-answer="correct">
                            زر الماوس اليمين → New → Folder 🖱️➡️📁
                        </button>
                        <button class="option-btn bg-amber-50 hover:bg-amber-100 p-4 rounded-lg text-right border-2 border-transparent" data-answer="wrong">
                            Enter مرتين
                        </button>
                    </div>
                </div>

                <!-- Question 15: Visual -->
                <div class="question-card bg-white rounded-xl shadow-lg p-6 mb-6 hidden" data-question="15">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">1️⃣5️⃣ لما بنكتب مستند في برنامج Word، ونحفظه، ده بيتخزن كـ:</h3>
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                        <button class="option-btn bg-emerald-50 hover:bg-emerald-100 p-4 rounded-lg text-center border-2 border-transparent" data-answer="wrong">
                            📁<br><span class="text-sm">مجلد</span>
                        </button>
                        <button class="option-btn bg-emerald-50 hover:bg-emerald-100 p-4 rounded-lg text-center border-2 border-transparent" data-answer="correct">
                            📄<br><span class="text-sm">File</span>
                        </button>
                        <button class="option-btn bg-emerald-50 hover:bg-emerald-100 p-4 rounded-lg text-center border-2 border-transparent" data-answer="wrong">
                            💻<br><span class="text-sm">برنامج</span>
                        </button>
                        <button class="option-btn bg-emerald-50 hover:bg-emerald-100 p-4 rounded-lg text-center border-2 border-transparent" data-answer="wrong">
                            🎵<br><span class="text-sm">تطبيق صوت</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Navigation Buttons -->
            <div class="flex justify-between items-center mt-8">
                <button id="prevBtn" class="bg-gray-500 text-white px-6 py-3 rounded-lg hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                    ⬅️ السابق
                </button>
                <button id="nextBtn" class="bg-blue-500 text-white px-6 py-3 rounded-lg hover:bg-blue-600 hidden">
                    التالي ➡️
                </button>
                <button id="finishBtn" class="bg-green-500 text-white px-6 py-3 rounded-lg hover:bg-green-600 hidden">
                    إنهاء الاختبار 🏁
                </button>
            </div>
        </div>

        <!-- Results -->
        <div id="results" class="hidden bg-white rounded-xl shadow-lg p-8 mt-8 text-center">
            <h2 class="text-3xl font-bold text-green-600 mb-4">🎉 مبروك! انتهيت من الاختبار</h2>
            <div class="text-6xl mb-4" id="scoreEmoji">🏆</div>
            <p class="text-2xl font-bold mb-4">النتيجة: <span id="finalScore" class="text-blue-600">0</span> من 15</p>
            <div id="scoreMessage" class="text-lg text-gray-600 mb-6"></div>
            <button onclick="location.reload()" class="bg-blue-500 text-white px-8 py-3 rounded-lg hover:bg-blue-600">
                🔄 إعادة الاختبار
            </button>
        </div>
    </div>

    <script>
        let currentQuestion = 1;
        let totalQuestions = 15;
        let score = 0;
        let selectedDevices = [];
        let matchingAnswers = {};
        let userData = {
            name: "",
            phone: "",
            email: "",
            score: 0
        };

        // Initialize
        document.getElementById('totalQ').textContent = totalQuestions;
        
        // تسجيل الدخول
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // جمع بيانات المستخدم
            userData = {
                name: document.getElementById('childName').value,
                phone: document.getElementById('parentPhone').value,
                email: document.getElementById('parentEmail').value,
                score: 0
            };
            
            // إخفاء نموذج التسجيل
            document.getElementById('loginSection').classList.add('hidden');
            
            // إظهار الاختبار
            document.getElementById('testContent').style.display = 'block';
            
            // إظهار السؤال الأول (تحسبًا لأي خطأ)
            document.querySelector('[data-question="1"]').classList.remove('hidden');
        });

        // Option button handlers
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('option-btn')) {
                const questionCard = e.target.closest('.question-card');
                const questionNum = questionCard.dataset.question;
                
                // Remove previous selections
                questionCard.querySelectorAll('.option-btn').forEach(btn => {
                    btn.classList.remove('correct', 'incorrect', 'border-green-500', 'border-red-500');
                });
                
                // Show result
                if (e.target.dataset.answer === 'correct') {
                    e.target.classList.add('correct', 'border-green-500');
                    score++;
                    showFeedback('صح! إجابة ممتازة 🎉', 'success');
                } else {
                    e.target.classList.add('incorrect', 'border-red-500');
                    // Show correct answer
                    questionCard.querySelectorAll('.option-btn').forEach(btn => {
                        if (btn.dataset.answer === 'correct') {
                            btn.classList.add('correct', 'border-green-500');
                        }
                    });
                    showFeedback('غلط! الإجابة الصحيحة محددة بالأخضر 📚', 'error');
                }
                
                setTimeout(() => {
                    document.getElementById('nextBtn').classList.remove('hidden');
                }, 1500);
            }
        });

        // Device selection for question 4
        document.addEventListener('click', function(e) {
            if (e.target.closest('.device-icon') && e.target.closest('[data-question="4"]')) {
                const device = e.target.closest('.device-icon');
                device.classList.toggle('selected');
                
                const deviceName = device.dataset.device;
                if (selectedDevices.includes(deviceName)) {
                    selectedDevices = selectedDevices.filter(d => d !== deviceName);
                } else {
                    selectedDevices.push(deviceName);
                }
                
                if (selectedDevices.length > 0) {
                    document.getElementById('checkDevices').classList.remove('hidden');
                }
            }
        });

        // Check devices answer
        document.getElementById('checkDevices').addEventListener('click', function() {
            const correctDevices = ['mouse', 'camera'];
            const isCorrect = correctDevices.every(d => selectedDevices.includes(d)) && 
                             selectedDevices.every(d => correctDevices.includes(d));
            
            if (isCorrect) {
                score++;
                showFeedback('ممتاز! الماوس والكاميرا هما Input Devices 🎯', 'success');
            } else {
                showFeedback('الإجابة الصحيحة: الماوس والكاميرا فقط 📝', 'error');
            }
            
            setTimeout(() => {
                document.getElementById('nextBtn').classList.remove('hidden');
            }, 2000);
        });

        // Drag and drop for matching
        let draggedElement = null;

        document.addEventListener('dragstart', function(e) {
            if (e.target.classList.contains('drag-item')) {
                draggedElement = e.target;
                e.target.style.opacity = '0.5';
            }
        });

        document.addEventListener('dragend', function(e) {
            if (e.target.classList.contains('drag-item')) {
                e.target.style.opacity = '1';
            }
        });

        document.addEventListener('dragover', function(e) {
            if (e.target.classList.contains('drop-zone') || e.target.closest('.drop-zone')) {
                e.preventDefault();
                const dropZone = e.target.classList.contains('drop-zone') ? e.target : e.target.closest('.drop-zone');
                dropZone.classList.add('drag-over');
            }
        });

        document.addEventListener('dragleave', function(e) {
            if (e.target.classList.contains('drop-zone')) {
                e.target.classList.remove('drag-over');
            }
        });

        document.addEventListener('drop', function(e) {
            if (e.target.classList.contains('drop-zone') || e.target.closest('.drop-zone')) {
                e.preventDefault();
                const dropZone = e.target.classList.contains('drop-zone') ? e.target : e.target.closest('.drop-zone');
                dropZone.classList.remove('drag-over');
                
                if (draggedElement) {
                    const droppedItems = dropZone.querySelector('.dropped-items');
                    droppedItems.appendChild(draggedElement.cloneNode(true));
                    draggedElement.style.display = 'none';
                    
                    matchingAnswers[draggedElement.dataset.device] = dropZone.dataset.type;
                }
            }
        });

        // Check matching
        document.getElementById('checkMatching').addEventListener('click', function() {
            const correctMatches = {
                'keyboard': 'input',
                'microphone': 'input',
                'printer': 'output',
                'monitor': 'output'
            };
            
            let correctCount = 0;
            for (let device in correctMatches) {
                if (matchingAnswers[device] === correctMatches[device]) {
                    correctCount++;
                }
            }
            
            if (correctCount === 4) {
                score++;
                showFeedback('ممتاز! كل التوصيلات صحيحة 🌟', 'success');
            } else {
                showFeedback(`صح ${correctCount} من 4. الكيبورد والمايك Input، الطابعة والشاشة Output`, 'error');
            }
            
            setTimeout(() => {
                document.getElementById('nextBtn').classList.remove('hidden');
            }, 2000);
        });

        // Sortable for ordering question
        let draggedStep = null;

        document.addEventListener('dragstart', function(e) {
            if (e.target.classList.contains('step-item')) {
                draggedStep = e.target;
                e.target.style.opacity = '0.5';
            }
        });

        document.addEventListener('dragend', function(e) {
            if (e.target.classList.contains('step-item')) {
                e.target.style.opacity = '1';
            }
        });

        document.addEventListener('dragover', function(e) {
            if (e.target.classList.contains('step-item')) {
                e.preventDefault();
            }
        });

        document.addEventListener('drop', function(e) {
            if (e.target.classList.contains('step-item') && draggedStep !== e.target) {
                e.preventDefault();
                const container = e.target.parentNode;
                const afterElement = getDragAfterElement(container, e.clientY);
                
                if (afterElement == null) {
                    container.appendChild(draggedStep);
                } else {
                    container.insertBefore(draggedStep, afterElement);
                }
            }
        });

        function getDragAfterElement(container, y) {
            const draggableElements = [...container.querySelectorAll('.step-item:not(.dragging)')];
            
            return draggableElements.reduce((closest, child) => {
                const box = child.getBoundingClientRect();
                const offset = y - box.top - box.height / 2;
                
                if (offset < 0 && offset > closest.offset) {
                    return { offset: offset, element: child };
                } else {
                    return closest;
                }
            }, { offset: Number.NEGATIVE_INFINITY }).element;
        }

        // Check order
        document.getElementById('checkOrder').addEventListener('click', function() {
            const steps = document.querySelectorAll('#sortableSteps .step-item');
            let isCorrect = true;
            
            steps.forEach((step, index) => {
                if (parseInt(step.dataset.order) !== index + 1) {
                    isCorrect = false;
                }
            });
            
            if (isCorrect) {
                score++;
                showFeedback('ممتاز! الترتيب صحيح تماماً 🎯', 'success');
            } else {
                showFeedback('الترتيب غير صحيح. راجع خطوات تشغيل الجهاز 📋', 'error');
            }
            
            setTimeout(() => {
                document.getElementById('nextBtn').classList.remove('hidden');
            }, 2000);
        });

        // Navigation
        document.getElementById('nextBtn').addEventListener('click', function() {
            if (currentQuestion < totalQuestions) {
                // Hide current question
                document.querySelector(`[data-question="${currentQuestion}"]`).classList.add('hidden');
                
                // Show next question
                currentQuestion++;
                document.querySelector(`[data-question="${currentQuestion}"]`).classList.remove('hidden');
                
                // Update progress
                updateProgress();
                
                // Hide next button
                this.classList.add('hidden');
                
                // Show finish button on last question
                if (currentQuestion === totalQuestions) {
                    document.getElementById('finishBtn').classList.remove('hidden');
                }
                
                // Enable previous button
                document.getElementById('prevBtn').disabled = false;
            }
        });

        document.getElementById('prevBtn').addEventListener('click', function() {
            if (currentQuestion > 1) {
                // Hide current question
                document.querySelector(`[data-question="${currentQuestion}"]`).classList.add('hidden');
                
                // Show previous question
                currentQuestion--;
                document.querySelector(`[data-question="${currentQuestion}"]`).classList.remove('hidden');
                
                // Update progress
                updateProgress();
                
                // Hide finish button
                document.getElementById('finishBtn').classList.add('hidden');
                
                // Disable previous button if first question
                if (currentQuestion === 1) {
                    this.disabled = true;
                }
            }
        });

        document.getElementById('finishBtn').addEventListener('click', function() {
            showResults();
        });

        function updateProgress() {
            const progress = (currentQuestion / totalQuestions) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQ').textContent = currentQuestion;
        }

        function showFeedback(message, type) {
            const feedback = document.createElement('div');
            feedback.className = `feedback ${type}`;
            feedback.textContent = message;
            document.body.appendChild(feedback);
            
            setTimeout(() => {
                feedback.remove();
            }, 3000);
        }

        // إرسال النتائج إلى Google Sheets وإرسال الإيميل
        async function sendResults(score) {
            userData.score = score;
            
            try {
                // إرسال البيانات إلى Google Apps Script
                const response = await fetch('https://script.google.com/macros/s/AKfycbyMP9I4bFjepdFZTpjDgDvvIKxbnzXTWN530NcqhX0ZpWzVkv31aN7bWxXQwUnMzernVg/exec', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(userData)
                });
                
                const result = await response.json();
                
                if (result.status === "success") {
                    showFeedback("تم إرسال النتيجة بنجاح! سيصلك إيميل بالتفاصيل", 'success');
                } else {
                    showFeedback("حدث خطأ أثناء حفظ النتيجة. الرجاء المحاولة لاحقًا", 'error');
                }
            } catch (error) {
                console.error('Error:', error);
                showFeedback("حدث خطأ أثناء إرسال البيانات", 'error');
            }
        }

        // دالة showResults المعدلة
        function showResults() {
            // Hide questions
            document.getElementById('testContent').style.display = 'none';
            
            // Show results
            const results = document.getElementById('results');
            results.classList.remove('hidden');
            
            // Calculate percentage
            const percentage = Math.round((score / totalQuestions) * 100);
            
            // Update score
            document.getElementById('finalScore').textContent = score;
            
            // Set emoji and message based on score
            let emoji, message;
            if (percentage >= 90) {
                emoji = '🏆';
                message = 'ممتاز جداً! أنت خبير في الكمبيوتر!';
            } else if (percentage >= 80) {
                emoji = '🌟';
                message = 'ممتاز! معلوماتك قوية جداً!';
            } else if (percentage >= 70) {
                emoji = '👍';
                message = 'جيد جداً! تحتاج مراجعة بسيطة!';
            } else if (percentage >= 60) {
                emoji = '📚';
                message = 'جيد! راجع المواضيع مرة تانية!';
            } else {
                emoji = '💪';
                message = 'لازم تراجع المواضيع أكتر!';
            }
            
            document.getElementById('scoreEmoji').textContent = emoji;
            document.getElementById('scoreMessage').textContent = message;

            // إرسال النتيجة
            sendResults(score);
        }
    </script>
</body>
</html>